

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Custom encryption &mdash; TeamSpeak SDK 3.1.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Custom passwords" href="passwords.html" />
    <link rel="prev" title="Filetransfer" href="filetransfer.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> TeamSpeak SDK
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.1.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../errors.html">TeamSpeak Error Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../properties.html">Property Enums</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enumerations.html">Structures &amp; Enumerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client_api.html">TeamSpeak Client Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server_api.html">TeamSpeak Server Functions</a></li>
</ul>
<p class="caption"><span class="caption-text">Server</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../server/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/basic.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/list-items.html">List available clients, channels, servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/vserver-manage.html">Create and stop virtual servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/advanced-create.html">Advanced virtual server creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/info.html">Retrieve and store information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/channels.html">Managing channels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/clients.html">Managing clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/whisper.html">Whisper lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/encryption.html">Custom encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/passwords.html">Custom passwords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/permissions.html">Permission checks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/security-salt.html">Security salts and hashes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/disable-commands.html">Disabling protocol commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/filetransfer.html">Filetransfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server/faq.html">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">Client</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="connections.html">Managing server connections</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="audio.html">Client Audio</a></li>
<li class="toctree-l1"><a class="reference internal" href="wave-files.html">Playing wave files</a></li>
<li class="toctree-l1"><a class="reference internal" href="3dsound.html">3D Sound</a></li>
<li class="toctree-l1"><a class="reference internal" href="whisper.html">Whisper lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="voice-encryption.html">Channel voice data encryption</a></li>
<li class="toctree-l1"><a class="reference internal" href="info.html">Retrieve and store information</a></li>
<li class="toctree-l1"><a class="reference internal" href="channels.html">Channel Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="client-list.html">List clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="client-kick.html">Kicking clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="local-mute.html">Muting other clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="textmessages.html">Text chat</a></li>
<li class="toctree-l1"><a class="reference internal" href="filetransfer.html">Filetransfer</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Custom encryption</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#enryption">Enryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="#decryption">Decryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="passwords.html">Custom passwords</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TeamSpeak SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Custom encryption</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="custom-encryption">
<h1>Custom encryption<a class="headerlink" href="#custom-encryption" title="Permalink to this headline">¶</a></h1>
<p>As an optional feature, the TeamSpeak 3 SDK allows users to implement
custom encryption and decryption for all network traffic. Custom
encryption replaces the default AES encryption implemented by the
TeamSpeak 3 SDK. A possible reason to apply custom encryption might be to
make ones TeamSpeak 3 client and server incompatible to other SDK
implementations.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Custom encryption must be implemented the same way in both the client
and server.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you do not want to use this feature, just don’t implement the two
encryption callbacks.</p>
</div>
<div class="section" id="enryption">
<h2>Enryption<a class="headerlink" href="#enryption" title="Permalink to this headline">¶</a></h2>
<p>To encrypt outgoing data, implement the callback</p>
<dl class="c struct">
<dt>
<em class="property">struct </em><code class="sig-name descname">ClientUIFunctions</code><br /></dt>
<dd><p>Defines available callbacks that you can receive. </p>
<p>Set the members of this struct to a function to call when the specific event happens. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="c var">
<dt>
void (*<code class="sig-name descname">onCustomPacketEncryptEvent</code>)<span class="sig-paren">(</span>char **dataToSend, unsigned int *sizeOfData<span class="sig-paren">)</span><br /></dt>
<dd><p>called for every packet to be sent to the server. Used to implement custom cryptography. </p>
<p>Only implement if you need custom encryption of network traffic. Replaces default encryption. If implemented Encryption and Decryption must be implemented the same way on both server and client.</p>
<p><dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dataToSend</span></code>: pointer to a byte array of data to be encrypted. Must not be freed. Write encrypted data to array. Replace array pointer with pointer to own buffer if you need more space. Need to take care of freeing your own memory yourself. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sizeOfData</span></code>: pointer to the size of the data array. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">dataToSend</span></code></p>
<p>Pointer to an array with the outgoing data to be encrypted.</p>
<p>Apply your custom encryption to the data array. If the encrypted data
is smaller than sizeOfData, write your encrypted data into the
existing memory of dataToSend. If your encrypted data is larger, you
need to allocate memory and redirect the pointer dataToSend. You need
to take care of freeing your own allocated memory yourself. The
memory allocated by the SDK, to which dataToSend is originally
pointing to, must not be freed.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">sizeOfData</span></code></p>
<p>Pointer to an integer value containing the size of the data array.</p>
</li>
</ul>
</div>
<div class="section" id="decryption">
<h2>Decryption<a class="headerlink" href="#decryption" title="Permalink to this headline">¶</a></h2>
<p>To decrypt incoming data, implement the callback</p>
<dl class="c struct">
<dt>
<em class="property">struct </em><code class="sig-name descname">ClientUIFunctions</code><br /></dt>
<dd><p>Defines available callbacks that you can receive. </p>
<p>Set the members of this struct to a function to call when the specific event happens. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="c var">
<dt>
void (*<code class="sig-name descname">onCustomPacketDecryptEvent</code>)<span class="sig-paren">(</span>char **dataReceived, unsigned int *dataReceivedSize<span class="sig-paren">)</span><br /></dt>
<dd><p>called for every packet received from the server. Used to implement custom cryptography. </p>
<p>Only implement if you need custom encryption of network traffic. Replaces default encryption. If implemented Encryption and Decryption must be implemented the same way on both server and client.</p>
<p><dl class="simple">
<dt><strong>Parameters</strong></dt><dd><ul class="breatheparameterlist simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dataReceived</span></code>: pointer to byte array of data to decrypt. Must not be freed. Write decrypted data to the array if large enough. Replace array pointer with pointer to own buffer if decrypted data exceeds the array size. Must take care to free own memory. </p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sizeOfData</span></code>: pointer to the size of the data array. </p></li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">dataReceived</span></code></p>
<p>Pointer to an array with the received data to be decrypted.</p>
<p>Apply your custom decryption to the data array. If the decrypted data
is smaller than dataReceivedSize, write your decrypted data into the
existing memory of dataReceived. If your decrypted data is larger,
you need to allocate memory and redirect the pointer dataReceived.
You need to take care of freeing your own allocated memory yourself.
The memory allocated by the SDK, to which dataReceived is originally
pointing to, must not be freed.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">dataReceivedSize</span></code></p>
<p>Pointer to an integer value containing the size of the data array.</p>
</li>
</ul>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Example code implementing a very simple XOR custom encryption and
decryption (also see the SDK examples):</p>
<div class="highlight-c notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">onCustomPacketEncryptEvent</span><span class="p">(</span><span class="kt">char</span><span class="o">**</span> <span class="n">dataToSend</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="o">*</span> <span class="n">sizeOfData</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">sizeOfData</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">(</span><span class="o">*</span><span class="n">dataToSend</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">CUSTOM_CRYPT_KEY</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">onCustomPacketDecryptEvent</span><span class="p">(</span><span class="kt">char</span><span class="o">**</span> <span class="n">dataReceived</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="o">*</span> <span class="n">dataReceivedSize</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">dataReceivedSize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">(</span><span class="o">*</span><span class="n">dataReceived</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">CUSTOM_CRYPT_KEY</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="passwords.html" class="btn btn-neutral float-right" title="Custom passwords" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="filetransfer.html" class="btn btn-neutral float-left" title="Filetransfer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, TeamSpeak Systems GmbH.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>